services:
  - type: web
    name: memoscan2
    env: docker
    plan: starter
    # Health check configuration
    healthCheckPath: /health
    # Environment variables
    envVars:
      # Required API Keys (set as secrets in Render dashboard)
      - key: OPENAI_API_KEY
        fromSecret: true
      - key: SCRAPFLY_KEY
        fromSecret: true
      # Security keys (generate and set as secrets)
      - key: SECRET_KEY
        fromSecret: true
      - key: ADMIN_API_KEY
        fromSecret: true
      # Storage configuration
      - key: PERSISTENT_DATA_DIR
        value: /data
      # CORS configuration
      - key: ALLOWED_ORIGINS
        value: https://memoscan2.onrender.com
      # Performance tuning
      - key: MAX_CONCURRENT_SCANS
        value: "8"
      - key: MAX_SCANS_PER_USER
        value: "15"
      - key: CACHE_MAX_SIZE_MB
        value: "150"
      - key: CACHE_MAX_ITEMS
        value: "1000"
      # Logging configuration
      - key: LOG_LEVEL
        value: INFO
      - key: JSON_LOGGING
        value: "true"
      # Data retention
      - key: RETENTION_DAYS
        value: "90"
      # Flask environment
      - key: FLASK_ENV
        value: production
    # Disk for persistent storage
    disk:
      name: memoscan-data
      mountPath: /data
      sizeGB: 10

# Add a disk for persistent data storage
disks:
  - name: memoscan-data
    sizeGB: 10
